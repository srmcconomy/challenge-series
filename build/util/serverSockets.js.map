{"version":3,"sources":["util/serverSockets.js"],"names":["socketMiddleware","connectStoreWithSocket","socket","next","action","newAction","type","startsWith","replace","emit","store","on","dispatch"],"mappings":";;;;;;;;QAKgBA,gB,GAAAA,gB;QAYAC,sB,GAAAA,sB;AAZT,SAASD,gBAAT,CAA0BE,MAA1B,EAAuC;AAC5C,SAAO,MAAOC,IAAD,IAAqCC,MAAD,IAAoB;AACnE,UAAMC,YAAYD,MAAlB;AACA,QAAIC,UAAUC,IAAV,CAAeC,UAAf,CAA0B,SAA1B,CAAJ,EAA0C;AACxCF,gBAAUC,IAAV,GAAiBD,UAAUC,IAAV,CAAeE,OAAf,CAAuB,SAAvB,EAAkC,EAAlC,CAAjB;AACD,KAFD,MAEO;AACLN,aAAOO,IAAP,CAAY,QAAZ,EAAsBJ,SAAtB;AACD;AACDF,SAAKE,SAAL;AACD,GARD;AASD;;AAEM,SAASJ,sBAAT,CAAgCS,KAAhC,EAA6DR,MAA7D,EAA0E;AAC/EA,SAAOS,EAAP,CAAU,QAAV,EAAoBP,UAAU;AAC5BM,UAAME,QAAN,cACKR,MADL;AAEEE,YAAO,WAASF,OAAOE,IAAK;AAF9B;AAID,GALD;AAMD","file":"util/serverSockets.js","sourcesContent":["// @flow\n\nimport type { Store } from 'redux';\nimport type { State, Action } from '../reducers';\n\nexport function socketMiddleware(socket: any) {\n  return () => (next: (action: Action) => null) => (action: Action) => {\n    const newAction = action;\n    if (newAction.type.startsWith('socket-')) {\n      newAction.type = newAction.type.replace('socket-', '');\n    } else {\n      socket.emit('action', newAction);\n    }\n    next(newAction);\n  };\n}\n\nexport function connectStoreWithSocket(store: Store<State, Action>, socket: any) {\n  socket.on('action', action => {\n    store.dispatch({\n      ...action,\n      type: `socket-${action.type}`,\n    });\n  });\n}\n"],"sourceRoot":"/source/"}