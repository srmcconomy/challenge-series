{"version":3,"sources":["util/routes.jsx"],"names":["store","token","request","onPlayerEnter","nextState","name","params","getState","enemyChecklist","playerList","has","dispatch","onKeyPlayerEnter","keyCounter","onItemPlayerEnter","itemChecklist","validate","replace","code","location","query","document","cookie","post","error","response","body","statusCode","data","JSON","parse","get","url","headers","Authorization","access_token","error2","response2","body2","data2","logo","redirectNonUser","console","log","players","toJS","pathname","App","TwitchAuthenticate","ChildChecklist","childChecklist","header","ChildChecklistFinalsLeaderboard","ChildChecklistLeaderboard","KeyCounterContainer","KeyCounterIndex","KeyCounterHeader","KeyCounter","KeyCounterLeaderboard","EnemyCounter","EnemyCounterIndex","EnemyChecklistHeader","EnemyCounterChecklist","EnemyChecklistLeaderboard","ItemChecklist","ItemChecklistIndex","ItemChecklistHeader","ItemChecklistList","ItemChecklistLeaderboard"],"mappings":"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","file":"routes.js","sourcesContent":["// @flow\n\nimport { Route, IndexRoute } from 'react-router';\nimport React from 'react';\nimport type { Store } from 'redux';\n\nimport App from '../components/App';\nimport TwitchAuthenticate from '../components/TwitchAuthenticate';\nimport Bingo from '../components/Bingo';\n\nimport setToken from '../actions/setToken';\nimport setCode from '../actions/setCode';\nimport setUser from '../actions/setUser';\nimport ChildChecklist from '../components/ChildChecklist';\nimport ChildChecklistHeader from '../components/ChildChecklistHeader';\nimport ChildChecklistList from '../components/ChildChecklistList';\nimport Validate from '../components/Validate';\nimport createNewChildPlayer from '../actions/createNewChildPlayer';\nimport ChildPopout from '../components/ChildPopout';\nimport ChildChecklistLeaderboard from '../components/ChildChecklistLeaderboard';\nimport ChildChecklistFinalsLeaderboard from '../components/ChildChecklistFinalsLeaderboard';\nimport createNewPlayer from '../actions/createNewPlayer';\nimport createNewKeyPlayer from '../actions/createNewKeyPlayer';\nimport createNewItemPlayer from '../actions/createNewItemPlayer';\nimport ItemChecklistHeader from '../components/ItemChecklistHeader';\nimport ItemChecklist from '../components/ItemChecklist';\nimport ItemChecklistList from '../components/ItemChecklistList';\nimport ItemChecklistIndex from '../components/ItemChecklistIndex';\nimport ItemChecklistLeaderboard from '../components/ItemChecklistLeaderboard';\nimport EnemyChecklistHeader from '../components/EnemyChecklistHeader';\nimport EnemyCounter from '../components/EnemyChecklist';\nimport EnemyCounterChecklist from '../components/EnemyChecklistList';\nimport EnemyCounterIndex from '../components/EnemyCounterIndex';\nimport EnemyChecklistLeaderboard from '../components/EnemyChecklistLeaderboard';\nimport KeyCounter from '../components/KeyCounter';\nimport KeyCounterIndex from '../components/KeyCounterIndex';\nimport KeyCounterContainer from '../components/KeyCounterContainer';\nimport KeyCounterHeader from '../components/KeyCounterHeader';\nimport KeyCounterLeaderboard from '../components/KeyCounterLeaderboard';\n\nexport default function (store: Store, token: ?string, request) {\n  function onPlayerEnter(nextState) {\n    const { name } = nextState.params;\n    if (!store.getState().enemyChecklist.playerList.has(name)) {\n      store.dispatch(createNewPlayer(name));\n    }\n  }\n\n  function onKeyPlayerEnter(nextState) {\n    const { name } = nextState.params;\n    if (!store.getState().keyCounter.has(name)) {\n      store.dispatch(createNewKeyPlayer(name));\n    }\n  }\n\n  function onItemPlayerEnter(nextState) {\n    const { name } = nextState.params;\n    if (!store.getState().itemChecklist.playerList.has(name)) {\n      store.dispatch(createNewItemPlayer(name));\n    }\n  }\n\n  function validate(nextState, replace) {\n    const { code } = nextState.location.query;\n    if (typeof document !== 'undefined') {\n      document.cookie = `token=${code}`;\n      token = code;\n    } else {\n      request.post(`https://api.twitch.tv/kraken/oauth2/token?client_id=rpj60fikezo717h9d7lka7zq7r1w97&client_secret=j4jbu16f73hkksncxfspvzx6q770dz&grant_type=authorization_code&redirect_uri=http://challenge-series.prettybigjoe.me/redirect&code=${code}`,\n        (error, response, body) => {\n          if (!error && response.statusCode === 200) {\n            const data = JSON.parse(body);\n            request.get({\n              url: 'https://api.twitch.tv/kraken/user',\n              headers: {\n                'Client-ID': 'rpj60fikezo717h9d7lka7zq7r1w97',\n                Authorization: `OAuth ${data.access_token}`,\n              },\n            }, (error2, response2, body2) => {\n              const data2 = JSON.parse(body2);\n              store.dispatch(setUser(data2.name, data2.logo, data.access_token, code));\n            });\n          }\n        }\n      );\n    }\n  }\n\n  function redirectNonUser(nextState, replace) {\n    console.log(store.getState().players.toJS());\n    console.log(token);\n    if (!token || !store.getState().players.has(token)) {\n      replace({\n        pathname: '/auth',\n      });\n    }\n  }\n\n  return (\n    <Route component={App} path=\"/\">\n      <Route component={TwitchAuthenticate} path=\"auth\" />\n      <Route path=\"redirect\" onEnter={validate} component={() => <Validate token={token} />} />\n      <Route component={ChildChecklist} path=\"childrace\" onEnter={redirectNonUser}>\n        <IndexRoute\n          onEnter={() => {\n            if (!store.getState().childChecklist.playerList.has(token)) {\n              store.dispatch(createNewChildPlayer(token));\n            }\n          }}\n          components={{\n            header: () => <ChildChecklistHeader token={token} />,\n            body: () => <ChildChecklistList token={token} />,\n          }}\n        />\n        <Route path=\"popout\" components={{ body: () => <ChildPopout token={token} /> }} />\n      </Route>\n      <Route\n        path=\"leaderboard\"\n        components={{\n          header: null,\n          body: ChildChecklistFinalsLeaderboard,\n        }}\n      />\n      <Route\n        path=\"fullleaderboard\"\n        components={{\n          header: null,\n          body: ChildChecklistLeaderboard,\n        }}\n      />\n      <Route component={KeyCounterContainer} path=\"key-counter\">\n        <IndexRoute\n          components={{\n            header: () => <div />,\n            body: KeyCounterIndex,\n          }}\n        />\n        <Route\n          path=\"user/:name\"\n          components={{\n            header: KeyCounterHeader,\n            body: KeyCounter,\n          }}\n          onEnter={onKeyPlayerEnter}\n        />\n        <Route\n          path=\"leaderboard\"\n          components={{\n            header: null,\n            body: KeyCounterLeaderboard,\n          }}\n        />\n      </Route>\n\n      <Route component={EnemyCounter} path=\"enemy-counter\">\n        <IndexRoute\n          components={{\n            header: () => <div />,\n            body: EnemyCounterIndex,\n          }}\n        />\n        <Route\n          path=\"user/:name\"\n          components={{\n            header: EnemyChecklistHeader,\n            body: EnemyCounterChecklist,\n          }}\n          onEnter={onPlayerEnter}\n        />\n        <Route\n          path=\"leaderboard\"\n          components={{\n            header: null,\n            body: EnemyChecklistLeaderboard,\n          }}\n        />\n      </Route>\n\n      <Route component={ItemChecklist} path=\"item-counter\">\n        <IndexRoute\n          components={{\n            header: () => <div />,\n            body: ItemChecklistIndex,\n          }}\n        />\n        <Route\n          path=\"user/:name\"\n          components={{\n            header: ItemChecklistHeader,\n            body: ItemChecklistList,\n          }}\n          onEnter={onItemPlayerEnter}\n        />\n        <Route\n          path=\"leaderboard\"\n          components={{\n            header: null,\n            body: ItemChecklistLeaderboard,\n          }}\n        />\n      </Route>\n    </Route>\n  );\n}\n"]}